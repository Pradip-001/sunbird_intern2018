"use strict";angular.module("playerApp").controller("LimitedPublishedContentController",["contentService","searchService","config","$rootScope","$state","toasterService","workSpaceUtilsService","$timeout","PaginationService","telemetryService",function(e,t,o,n,r,s,i,a,l,d){function m(e,t,o,n){var r={};return r.showError=!0,r.isClose=e,r.message=t,r.messageType=o,n&&(r.messageText=n),r}var c=this;c.userId=n.userId,c.status=["Unlisted"],c.sortBy="desc",c.selectedContentItem=[],c.pageLimit=9,c.pager={},c.getlimitedpublishedContent=function(e){e=e||1,c.loader=s.loader("",n.messages.stmsg.m0082),c.error={};var r={filters:{status:c.status,createdBy:c.userId,objectType:"Content",contentType:o.contributeContentType},sort_by:{lastUpdatedOn:c.sortBy},offset:(e-1)*c.pageLimit,limit:c.pageLimit};t.search(r).then(function(t){t&&"OK"===t.responseCode?(c.error.showError=!1,c.loader.showLoader=!1,c.pager=l.GetPager(t.result.count,e,c.pageLimit),c.limitedpublishedContentData=t.result.content||[],c.totalCount=t.result.count,c.pageNumber=e,c.version=t.ver,0===c.limitedpublishedContentData.length&&(c.error=m(!0,n.messages.stmsg.m0083,n.messages.stmsg.m0008))):(c.error.showError=!1,c.loader.showLoader=!1,s.error(n.messages.fmsg.m0064))}).catch(function(){c.error.showError=!1,c.loader.showLoader=!1,s.error(n.messages.fmsg.m0064)})},c.openContentPlayer=function(e){i.openContentEditor(e,r.current.name)},c.initializeUIElement=function(){$("#actionDropDown").dropdown()},c.openRemoveContentModel=function(e){c.removeContentId=e,c.showRemoveContentModel=!0,a(function(){$("#removeContentModel").modal({}).modal("show")},10)},c.hideRemoveContentModel=function(){i.hideRemoveModel("#removeContentModel"),c.removeContentId="",c.showRemoveContentModel=!1},c.deleteContent=function(t){var o=[t];c.hideRemoveContentModel(),c.loader=s.loader("",n.messages.stmsg.m0034);var r={contentIds:o};e.retire(r).then(function(e){e&&"OK"===e.responseCode?(c.loader.showLoader=!1,c.selectedContentItem=[],c.version=e.ver,s.success(n.messages.smsg.m0006),c.limitedpublishedContentData=i.removeContentLocal(c.limitedpublishedContentData,o),c.pager=l.GetPager(c.totalCount-o.length,c.pageNumber,c.pageLimit),0===c.limitedpublishedContentData.length&&c.getlimitedpublishedContent(c.pager.currentPage)):(c.loader.showLoader=!1,s.error(n.messages.fmsg.m0022))}).catch(function(){c.loader.showLoader=!1,s.error(n.messages.fmsg.m0022)})},c.setPage=function(e){e<1||e>c.pager.totalPages||c.getlimitedpublishedContent(e)},c.initTocPopup=function(){$(".cardTitleEllipse").popup({inline:!0})},c.generateInteractEvent=function(e,t){d.interactTelemetryData("workspace",t,e,"1.0","unlistedContent","workspace-unlisted-content")};var u=[];c.lineInView=function(e,t,o,n){var r=_.filter(u,function(e){return e.objid===o.identifier});!0===t&&0===r.length&&u.push({objid:o.identifier,objtype:o.contentType||"workspace",section:n,index:e}),console.log("------",u),d.setVisitData(u)}}]);