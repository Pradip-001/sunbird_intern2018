"use strict";angular.module("playerApp").controller("ContentLessonController",["contentService","$timeout","$state","config","$rootScope","toasterService","$scope","configService",function(e,o,r,a,t,n,d,s){var c=this;c.formDropdown=s.getWorkspaceStdMtrlDrpdown(),c.languages=c.formDropdown.languages,c.grades=c.formDropdown.grades,c.mediums=c.formDropdown.medium,c.subjects=c.formDropdown.subjects,c.boards=c.formDropdown.boards,c.resourceType=c.formDropdown.resourceType,c.showCreateSlideShowModal=!1,c.slideShowCreated=!1,c.userId=t.userId,c.accept=!1,c.hideCreateSlideShowModal=function(){$("#createSlideShowModal").modal("hide"),$("#createSlideShowModal").modal("hide others"),$("#createSlideShowModal").modal("hide dimmer")},c.initilizeView=function(){c.showCreateSlideShowModal=!0,o(function(){$(".multiSelectDropDown").dropdown(),$(".singleSelectDropDown").dropdown(),$("#createSlideShowModal").modal({allowMultiple:!0,observeChanges:!0,onHide:function(){c.clearCreateSlideShowData(),c.slideShowCreated||r.go("WorkSpace.ContentCreation")}}).modal("show")},10)},c.createContent=function(o){e.create(o).then(function(e){e&&"OK"===e.responseCode?(c.slideShowCreated=!0,c.showCreateSlideShowModal=!1,c.loader.showLoader=!1,c.hideCreateSlideShowModal(),c.initEKStepCE(e.result.content_id)):(c.loader.showLoader=!1,n.error(t.messages.fmsg.m0007))}).catch(function(){c.loader.showLoader=!1,n.error(t.messages.fmsg.m0007)})},c.saveMetaData=function(e,o){c.framework=o,c.loader=n.loader("",t.messages.stmsg.m0013);var r=angular.copy(e);r.mimeType=a.CreateLessonMimeType,r.createdBy=c.userId,r.name=r.name?r.name:"Untitled lesson",r.contentType="Resource",r.framework=c.framework,r.concepts=c.concepts,r.resourceType=r.resourceType||"Learn",r.language&&(r.language=[r.language]);var d={content:r};c.createContent(d)},c.clearCreateSlideShowData=function(){c.data={}},c.initEKStepCE=function(e){var o={contentId:e,framework:c.framework};r.go("ContentEditor",o)},d.$on("selectedConcepts",function(e,o){c.concepts=o.selectedConcepts});var i=t.$on("CreateLesson",function(e,o){c.saveMetaData(o.Data,o.framework)});d.$on("$destroy",function(){i()})}]);