"use strict";angular.module("playerApp").controller("profileVisibilityController",["$timeout","$rootScope","$scope","toasterService","userService","telemetryService",function(e,i,l,r,t,o){var s=this;s.options=[{text:"Hide this from everyone",value:"private"},{text:"Show this to all",value:"public"}],s.loader={},s.privateProfileFields=[],s.publicProfileFields=[],l.visibility=i.privateProfileFields.indexOf(l.field)>=0?"private":"public",s.initDropdown=function(){e(function(){$(".profile-privacy-drpdwn").dropdown()},100)},s.setProfileFieldLbl=function(e){if(l.visibility!==e){var t={field:l.field,visibility:e,update:l.update};s.updateProfVisFields(t,function(o,d){o?r.error(i.messages.fmsg.m0048):(l.visibility=e,r.success(i.messages.smsg.m0040)),s.loader[t.field]=!1,s.privateProfileFields=[],s.publicProfileFields=[]})}},s.updateProfVisFields=function(e,l){s.loader[e.field]=!0;var r={request:{userId:i.userId}};"private"===e.visibility?(-1===s.privateProfileFields.indexOf(e.field)&&s.privateProfileFields.push(e.field),_.remove(s.publicProfileFields,function(i){return i===e.field})):"public"===e.visibility&&(-1===s.publicProfileFields.indexOf(e.field)&&s.publicProfileFields.push(e.field),_.remove(s.privateProfileFields,function(i){return i===e.field})),s.privateProfileFields.length>0&&(r.request.private=s.privateProfileFields),s.publicProfileFields.length>0&&(r.request.public=s.publicProfileFields),t.updateProfileFieldVisibility(r).then(function(e){e&&"OK"===e.responseCode?l(null,e):l(e,null)})},s.generateInteractEvent=function(e,r){var t=o.ProfileLockConfig[l.field];o.interactTelemetryData("profile",i.userId,l.field,r,t,e)}}]);