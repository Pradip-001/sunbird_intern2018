"use strict";angular.module("playerApp").controller("announcementOutboxListController",["$rootScope","$scope","$timeout","$state","$stateParams","toasterService","announcementAdapter","PaginationService","telemetryService",function(e,n,t,o,a,u,c,s,r){var i=this;i.init=function(){i.pager={},i.pageLimit=25,i.showLoader=!0,i.showDataDiv=!1;var e=parseInt(a.page)||1;i.renderAnnouncementList(e)},i.renderAnnouncementList=function(e){c.getOutBoxAnnouncementList(i.pageLimit,e).then(function(n){i.showLoader=!1,i.totalCount=n.result.count,i.result=n.result,i.listData=n.result.announcements,i.pageNumber=e,i.pager=s.GetPager(n.result.count,e,i.pageLimit),i.listData.length>0&&(i.showDataDiv=!0)},function(e){e&&(i.showLoader=!1)})},i.setPage=function(e){e<1||e>i.pager.totalPages||o.go("announcementOutbox",{page:e})},i.showModal=function(e,n){i.announcementId=n,$("#"+e).modal("show")},i.closeModal=function(e){$("#"+e).modal("hide")},i.deleteAnnouncement=function(){c.deleteAnnouncement(i.announcementId).then(function(n){"cancelled"===n.result.status?(i.closeModal("announcementDeleteModal"),u.success(e.messages.smsg.moo41),_.forEach(i.listData,function(e,n){if(i.announcementId===e.id)return i.listData[n].status="cancelled",e})):(u.error(n.params.errmsg),i.closeModal("announcementDeleteModal"))},function(e){e&&i.closeModal("announcementDeleteModal")})},i.getResend=function(e,n){o.go("announcementResend",{announcementId:e,stepNumber:"1",telemetryAnnTitle:n})},i.showAnnouncementDetails=function(e,n){o.go("announcementDetails",{announcementId:e,announcementName:n.title,pageId:"announcement_outbox_view"})},i.gotToAnnouncementCreateState=function(){o.go("announcementCreate",{stepNumber:"1"})}}]);