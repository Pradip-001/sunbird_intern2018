"use strict";angular.module("playerApp").service("userService",["config","restfulContentService","restfulLearnerService",function(r,t,e){function n(r){return Math.floor(Math.random()*parseInt("8"+"9".repeat(r-1))+parseInt("1"+"0".repeat(r-1)))}this.currentUserProfile={},this.resourceBundle=function(e,n){var i=r.URL.CONFIG_BASE+r.URL.USER.RESOURCE_BUNDLE+"/"+n+"/"+e;return t.get(i)},this.getUserProfile=function(t,n){var i=r.URL.USER.GET_PROFILE+"/"+t;return n&&_.isString(n)&&(i=i+"?fields="+n),e.get(i)},this.updateUserProfile=function(t,n,i){var s=r.URL.USER.UPDATE_USER_PROFILE;return e.patch(s,t)},this.getTenantLogo=function(){return t.get(r.URL.USER.TENANT_LOGO)},this.setCurrentUserProfile=function(r){this.currentUserProfile=r},this.getCurrentUserProfile=function(){return this.currentUserProfile},this.getSkills=function(){var t=r.URL.USER.SKILLS;return e.get(t)},this.getUserSkills=function(t){var n=r.URL.USER.USER_SKILLS;return e.post(n,t)},this.addSkills=function(t){var n=r.URL.USER.ADD_SKILLS;return e.post(n,t)},this.updateProfileFieldVisibility=function(t){var n=r.URL.USER.UPDATE_PROF_VIS_FIELDS;return e.post(n,t)},this.getUserHash=function(r){var t=r+(new Date).getTime()+n(5);return md5(t)},this.searchUsers=function(t){var n=[];return this.searchOrgs(t).then(function(i){n=_.map(i.result.response.content,function(r){return _.get(r,"identifier")}),n.push(t),n=_.uniq(n);var s={request:{filters:{"organisations.organisationId":n}}};return e.post(r.URL.ADMIN.USER_SEARCH,s)}).catch(function(i){console.log(i),n.push(t);var s={request:{filters:{"organisations.organisationId":n}}};return e.post(r.URL.ADMIN.USER_SEARCH,s)})},this.searchOrgs=function(t){var n={request:{filters:{rootOrgId:t}}};return e.post(r.URL.ADMIN.ORG_SEARCH,n)}}]);